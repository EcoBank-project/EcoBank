<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ecobank.app.sns.mapper.SnsReplyMapper">

	<!-- 단건조회 -->
	<select id="selectSnsReplyInfo" resultType="SnsReplyVO">
		SELECT  s.reply_no	
			 	,s.reply_content
				,s.reply_createAt
				,s.user_no
				,s.feed_no
                ,u.nickname
		FROM sns_reply s 
				LEFT JOIN users u
                 	ON s.user_no = u.user_no
		WHERE s.feed_no = #{feedNo}
		ORDER BY s.reply_no DESC
	</select>
	
	<!-- 등록 -->
	<insert id="insertSnsReplyInfo" parameterType="SnsReplyVO">
		<selectKey keyProperty="replyNo" 
					resultType="Integer"
					order="BEFORE">
			SELECT NVL(MAX(reply_no),1)+1
			FROM sns_reply
		</selectKey>
		INSERT INTO sns_reply 
		(
			 reply_no	
			 ,reply_content
			 ,reply_createAt
			 ,user_no
			 ,feed_no
			 )
		VALUES
		(
			#{replyNo}
			,#{replyContent}
			,#{replyCreateAt}
			,#{userNo}
			,#{feedNo}
			)
	</insert>
	
	
	<!-- 삭제 -->
	<delete id="deleteSnsReplyInfo" parameterType="int">
		DELETE FROM sns_reply
		WHERE reply_no = #{replyNo}
	</delete>

</mapper>