<!DOCTYPE html>

<th:block xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
	th:fragment="myHeaderFragment">
	<div class="my-header">
		<!-- 프로필 이미지와 사용자 정보 -->
		<div class="profile-section">
			<div class="profile-container">
				<img th:src="@{/img/defaultProfile.jpg}" alt="기본 이미지"
					class="profile-image" />
			</div>
			<div class="user-info">
				<p>
					<span th:text="${session.nickname}"></span>님의 마이페이지
				</p>
			</div>
		</div>

		<!-- 정보 레이아웃 -->
		<div class="info-section">
			<div class="info-item">
				<p class="info-label">포인트</p>
				<p id="points" class="info-value">0</p>
			</div>
			<div class="info-item">
				<p class="info-label">팔로워</p>
				<p id="follower" class="info-value">0</p>
			</div>
			<div class="info-item">
				<p class="info-label">팔로잉</p>
				<p id="following" class="info-value">0</p>
			</div>
		</div>
	</div>
	<style>
.my-header {
	display: flex;
	align-items: center;
	justify-content: space-between;
	padding: 20px;
}

.profile-section {
	display: flex;
	align-items: center;
}

.profile-container {
	margin-right: 20px;
}

.profile-image {
	width: 100px;
	height: 100px;
	border-radius: 50%;
	border: 3px solid #ccc;
	object-fit: cover;
}

.user-info p {
	margin: 0;
	font-size: 16px;
}

.user-info span {
	font-weight: bold;
}

.info-section {
	display: flex;
	justify-content: space-between;
	width: 300px;
}

.info-item {
	text-align: center;
}

.info-label {
	font-size: 14px;
	margin: 0;
}

.info-value {
	font-size: 16px;
	font-weight: bold;
	margin: 0;
}
</style>
	<script>
		$(document).ready(function() {
			// AJAX 요청으로 사용자 정보 가져오기
			$.ajax({
				url : '/user/info',
				method : 'GET',
				success : function(data) {
					$('#points').text(data.totalScore == null? 0 :data.totalScore);
					$('#follower').text(data.followerCount);
					$('#following').text(data.followingCount);
				},
				error : function(xhr, status, error) {
					console.error('사용자 정보 가져오기 오류:', status, error);
				}
			});
		});
	</script>
</th:block>